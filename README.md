# Simple Emailer Exec

Утилита, позволяющая отправлять письма из терминала по протоколу SMTP Gmail.

<p align="center">
    <img alt="Широ ^-^" width="500" src="https://i.ibb.co/gyjPNyr/shiro.gif"/>
</p>

<p align="center">
    <img alt="Python 3.12" src="https://img.shields.io/badge/Python-3.12-yellow?style=flat">
    <img alt="Версия 0.1.0" src="https://img.shields.io/badge/%D0%92%D0%B5%D1%80%D1%81%D0%B8%D1%8F-0.1.0-purple?style=flat">
    <img alt="Лицензия MIT" src="https://img.shields.io/badge/%D0%9B%D0%B8%D1%86%D0%B5%D0%BD%D0%B7%D0%B8%D1%8F-MIT-aqua?style=flat">
</p>

## Содержание

- [Установка утилиты](#установка-утилиты);

- [Настройка файла конфигурации](#настройка-файла-конфигурации);

  - [Настройка логирования](#настройка-логирования);

  - [Настройка писем](#настройка-писем).

- [Использование утилиты](#использование-утилиты);

  - [Windows - исполняемый файл](#windows---исполняемый-файл);

  - [Python - pip](#python---pip);

  - [Python - poetry](#python---poetry).

- [Аргументы](#аргументы);

- [Примеры использования утилиты](#примеры-использования-утилиты).

## Установка утилиты

1. Скачайте и распакуйте архив с утилитой из раздела Releases ИЛИ клонируйте репозиторий git;

1. Переименуйте файл *.env.dist* в *.env* и заполните поля:

    - **SENDER_EMAIL**;

    Адрес электронной почты, с которой будут отправляться письма.

    - **SENDER_PASSWORD**.

    Пароль от приложения *Google*. Подробнее смотрите в разделе *"Пароли приложений"* раздела *"Безопасность"* вашего аккаунта.

1. Настройте файл конфигурации *config.json* и файлы писем (подробнее смотрите ниже).

## Настройка файла конфигурации

Файл конфигурации *config.json* содрежит два основных параметра - *emails* и *logging*. Сначала поговорим про второй.

### Настройка логирования

- **file_name**;

    Название файла, в который будут записываться данные журнала.

- **format_file**;

    Формат записи данных в файл. Подробнее смотрите в документации модуля *Loguru*.

- **format_std**;

    Формат вывода даных логирования в терминал. Подробнее смотрите в документации модуля *Loguru*.

- **level**.

    Минимальный уровень логирования для записи в файл и вывода в терминал. Подробнее смотрите в документации модуля *Loguru*.

### Настройка писем

- **_default**;

    Письмо по умолчанию, которое будет отправляться, если аргумент **-e** не указан.

- **some_email_name_1**.

    Настройки для письма "some_email_name_1".

#### Структура настроек письма

- **filename**;

    Название файла письма в папке *emails*

- **subject**;

    Заголовок письма.

- **type**;

    Тип форматирования текста письма (например, "plain" или "html"). Подробнее смотрите в модуле *email.mime.text*.

- **with_args**.

    Имеет ли отправляемое письмо аргументы для форматирования.

## Использование утилиты

### Windows - исполняемый файл

```shell
.\simple_emailer_exec.exe [аргументы]
```

### Python - pip

#### Windows

```shell
python -m venv .\venv
.\venv\Scripts\activate
python -m pip install -r .\requirements.txt
python .\simple_emailer_exec\ [аргументы]
```

#### Linux

```bash
python3 -m venv ./venv
source ./venv/bin/activate
python3 -m pip install -r ./requirements.txt
python3 ./simple_emailer_exec/ [аргументы]
```

### Python - poetry

#### Windows

```shell
poetry install
poetry run python .\simple_emailer_exec\ [аргументы]
```

#### Linux

```bash
poetry install
poetry run python3 ./simple_emailer_exec/ [аргументы]
```

## Аргументы

- **-r**;

    Адрес электронной почты получателя письма. Обязательный параметр, без него утилита не запустится.

- **-e**;

    Название письма (ключ в конфигурации *emails*). Если не указан - будет использовано значение по умолчанию *"_default"*.

- **-s**;

    Заголовок письма. Если не указан - будет использовано значение из файла конфигурации.

- **-t**;

    Тип форматирования текста письма. Если не указан - будет использовано значение из файла конфигурации.

- **other**;

    Дополнительные аргументы вида *"ключ=значение"*. Будут использованы для форматирования текста письма.

## Примеры использования утилиты

Примеры будут показаны с использованием исполняемого файла, ибо так надо меньше писать.

### Отправка письма без дополнительных аргументов форматирования

```shell
.\simple_emailer_exec.exe -r some_email@example.com -e example_without_args
```

### Отправка письма без дополнительных аргументов с другим заголовоком

```shell
.\simple_emailer_exec.exe -r some_email@example.com -e example_without_args -s "В этом письме будет такой заголовок."
```

### Отправка письма с дополнительными аргументами

```shell
.\simple_emailer_exec.exe -r some_email@example.com -e example_with_args name=Shuwiku gift_id=12345
```

### Отправка письма по умолчанию

```shell
.\simple_emailer_exec.exe -r some_email@example.com
```
